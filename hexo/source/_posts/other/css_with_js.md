---
title: css和js
tags: [css]
categories: other
---

## 巧合
人生可能就是巧合组成的，只不过有些我们能意识到，而大多数都不能。 今天在code review上讨论过css in js后，突然想起实习时的公司里一位大神，鬼使神差地去lark里搜了下，居然真的在字节，翻了翻okr，也让我找到一个css in js的ppt分享。注定是要思考学习的一天。不管是对技术还是对人，要保持谦卑的态度啊少女（并不少了）。这也不算一篇纯技术文章，就随便唠唠吧。

## css in js
lynx代码目前用的是jsx语法，api与react类似，目前采用的是bem+scss的方案管理css（有react lynx编译的限制），但是余老板建议使用css in js的方案。

css in js确实有其独特的优势：解决样式覆盖问题、减少无用css代码、封装好后组件可移植性强。

凯神的分享正好介绍了一些css in jss的库：
1. JSS: 先驱者，依旧在维护。

   个人使用感受：没用过，没有发言权。

2. css-modules: hash化的className名

    个人使用感受：这是我第一次参与react项目时，项目里使用的方案。我到今天才知道这算是css in js。

    优点：利用hash解决了全局样式覆盖问题
    
    缺点：
    1. 相较于传统写法，使用的时候多一步类名取值
    2. 需要拼接类名时复杂一些
    
3. styled-components: 写法上利用带标签的字符串，抛弃className。渲染时也使用了hash className去避免样式覆盖。

    个人使用感受：接触较少，只在pd里写组件时用过。
    
    优点：确实很有效地解决了样式覆盖(无论如何都不会被覆盖)、js变量使用的问题。可以使用js变量和js代码，很好地弥补了css无法计算和预编译语言函数功能弱的问题。
    
    缺点：
    1. 文件里的代码行数明显多了起来。
    2. 元素/类间复用样式比较麻烦。

    以上提到的缺点可能也跟pd的组件拆分和组件规划有关，仅代表个人观点。
    
    注意：开发组件库时，需要预留props里的className来方便使用者控制样式。

4. emotion: css prop?

   个人使用感受：没用过，没有发言权。

5. theme-ui: 强制将自由的样式约束为整体设计的一部分

   个人使用感受：没用过，没有发言权。但看官网介绍，类似于tailwindcss的思想，将css样式原子化？

相较于预编译语言，css in js无疑提供了更为强大和全面的功能。

是否采用一项技术，一些小的思考：
1. 它解决了什么问题/痛点
2. 带来多大的开发和维护成本，带来的收益是否足以抵消这些成本
3. 性能是否会有影响
4. 业务和组件库有不一样的标准
    业务：封装是否良好，迁移/移植是否方便，是否方便管理
    组件库：是否会影响使用者，是否会和使用者项目里的技术/依赖冲突
5. 是否带来项目/代码质量的优化

对于我来说的新知识：
- [CSSStyleSheet.insertRule()](https://developer.mozilla.org/zh-CN/docs/Web/API/CSSStyleSheet/insertRule)
